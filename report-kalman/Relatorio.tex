%% Adaptado de 
%% http://www.ctan.org/tex-archive/macros/latex/contrib/IEEEtran/
%% Traduzido para o congresso de IC da USP
%%*****************************************************************************
% Não modificar

\documentclass[twoside,conference,a4paper]{IEEEtran}

%******************************************************************************
% Não modificar
\usepackage{IEEEtsup} % Definições complementares e modificações.
\usepackage[latin1]{inputenc} % Disponibiliza acentos.
\usepackage[english,brazil]{babel}
%% Disponibiliza Inglês e Português do Brasil.
\usepackage{latexsym,amsfonts,amssymb} % Disponibiliza fontes adicionais.
\usepackage{theorem} 
\usepackage[cmex10]{amsmath} % Pacote matemático básico 
\usepackage{url} 
%\usepackage[portuges,brazil,english]{babel}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{color}
\usepackage[pagebackref=true,breaklinks=true,letterpaper=true,colorlinks,bookmarks=false]{hyperref}
\usepackage[tight,footnotesize]{subfigure} 
\usepackage[noadjust]{cite} % Disponibiliza melhorias em citações.
\usepackage{listings}
\usepackage{todonotes}
%%*****************************************************************************

\begin{document}
\selectlanguage{brazil}
\renewcommand{\IEEEkeywordsname}{Palavras-chave}

%%*****************************************************************************

\urlstyle{tt}
% Indicar o nome do autor e o curso/nível (grad-mestrado-doutorado-especial)
\title{MO810 - Trabalho Final}
\author{%
 \IEEEauthorblockN{Luísa Madeira Cardoso\,\IEEEauthorrefmark{1}}
 \IEEEauthorblockA{\IEEEauthorrefmark{1}%
                   Aluno especial - Mestrado \\
                   E-mail: lu.madeira2@gmail.com}
}

%%*****************************************************************************

\maketitle

%%*****************************************************************************
% Resumo do trabalho
\begin{abstract}
O objetivo deste trabalho é a implementação de um sistema de localização.

\end{abstract}

% Indique três palavras-chave que descrevem o trabalho
\begin{IEEEkeywords}
 V-REP Pioneer AvoidCollision WallFollow Fuzzy
\end{IEEEkeywords}

%%*****************************************************************************
% Modifique as seções de acordo com o seu projeto

\section{Introdução}

Este projeto consiste no desenvolvimento de um sistema de controle para o \textit{Pioneer P3-DX} no simulador \textit{V-REP}. A implementação foi realizada em Python 3.5, com a utilização de algumas bibliotecas como o Scikit-fuzzy e Matplotlib. Os ciclos de atualização de leitura do sensores acontecem por padrão a cada 200ms. O código fonte pode ser obtido em https://github.com/luwood/MO810-vrep-python. As instruções de instalação se encontram no README do projeto. 

Este artigo está dividido em três sessões principais, cada uma com sua apresentação e discussão dos resultados.

\begin{itemize}
 \item Localização de Landmarks
 \item Filtro de Kalman
\end{itemize}


\section{Odometria}
O cálculo da odometria foi realizado com base na estimativa de velocidade das rodas. A implementação deste componente está na classe \textit{OdometryPoseUpdater}. 

\subsection{Rodas}
Cada roda possui um \textit{encoder} que provê sua posição angular. Através da coleta temporal desta informação é possível determinar sua velocidade utilizando a seguinte fórmula:
 
\[ V = \frac{\Delta \theta}{\Delta time} R \]

Em que \( \Delta \theta \) representa a diferença angular entre posições do \textit{encoder} durante um intervalo de tempo \(\Delta time\) e \(R\) é o raio da roda. É importante destacar que o cálculo da diferença angular deve levar em conta a orientação do giro e o universo em que os ângulos estão.  

A implementação do cálculo de velocidade da roda encontra-se na classe \textit{Wheel}. A orientação do giro é obtida utilizando a hipótese que a diferença angular deve ser sempre menor do que \( \pi \). 

\subsection{Velocidade do Robô diferencial}
Dada a velocidade de cada roda, pode-se calcular a velocidade linear e angular do robô através da fórmula:

\[ V = \frac{V_r + V_l}{2}\]
\[ \omega = \frac{V_r - V_l}{D}\]

Em que \(V_r\) é a velocidade da roda direita, \(V_l\) é a roda esquerda, \(D\) é a distância entre as rodas, \(V\) é a velocidade linear e \(\omega\) é a velocidade angular. 

\subsection{Pose}
A pose do robô é então calculada 


\begin{lstlisting}[language=python]
x = lastPose.x + (deltaSpace * cos( \ 
    addDelta(lastPose.orientation, deltaTheta/2)))
y = lastPose.y + (deltaSpace * sin( \ 
    addDelta(lastPose.orientation, deltaTheta/2)))
theta = addDelta(lastPose.orientation, \
                 deltaTheta)
        
\end{lstlisting}

\subsection{Resultados}

O gráfico comparando a posição real do robô e a posição calculada através da odometria pose ser visto na figura~\ref{fig:fig0}. É possível observar que o trajeto em linha reta obtido pela odometria é preciso. Porém assim que a primeira curva é realizada a diferença entre as posições começa a divergir. A diferença torna-se maior a cada iteração devido aos erros acumulados. A tabela \ref{tab:tab1} mostra a evolução do erro no cálculo da orientação durante um determinado período de teste. 

\begin{table}[ht]
\renewcommand{\arraystretch}{1.3}
\centering
 \caption{Diferença \(\theta\) em graus - a cada 200ms}
 \label{tab:tab1}
 \begin{tabular}{lcc}\hline
Real & Odometria & Erro \\ \hline \hline
  -0.424  & -0.406    & 0.018 \\
-0.515  & -0.488    & 0.027 \\
-0.783  & -0.718    & 0.065 \\
-1.182  & -1.065    & 0.117 \\
-2.033  & -1.818    & 0.215 \\
-3.048  & -2.724    & 0.324 \\
-4.355  & -3.861    & 0.494 \\
-6.122  & -5.416    & 0.706 \\
-7.843  & -6.953    & 0.89  \\
-9.851  & -8.747    & 1.104 \\
-12.613 & -11.227   & 1.386 \\
-14.864 & -13.288   & 1.576 \\
-18.003 & -16.129   & 1.874 \\
-22.479 & -20.084   & 2.395 \\ \hline
 \end{tabular}
\end{table}

Pode-se concluir que a odometria é um método de estimativa extremamente suscetível a erros acumulados. Para tornar este método viável seria necessário necessário realizar correções no cálculo da orientação. A utilização de uma bússola, por exemplo, poderia auxiliar nesta computação. 


\begin{figure}[ht]
\centering
\includegraphics[width=1\hsize]{images/odometry.png}
\caption{Odometria: Linha vermelha, Ground Thruth: Linha azul - Exemplo com script rodando algoritmo de Braitenberg}
\label{fig:fig0}
\end{figure}

\section{Localizando Landmarks}
Localizando landmarks. 

\section{Filtro de Kalman}

Filtro de Kalman. \cite{thrun2005probabilistic}


\section{Resultados}

Filtro de Kalman é muito bom. 


%******************************************************************************
% Referências - Definidas no arquivo Relatorio.bib
 +-------------+

\bibliographystyle{IEEEtran}

\bibliography{Relatorio}


%******************************************************************************



\end{document}
